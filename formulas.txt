"contrato.valor_total_do_contrato+100*2+200\nvalor_ativo = sum(contrato.medicao_de_contrato_bm.pedido_sap_de_bm.medicao_atual, contrato.medicao_de_contrato_bm.medicao_vigente = 'Sim')\nsum(contrato.medicao_de_contrato_bm.ftd_de_bm.valor_total_da_nota_fiscal, contrato.medicao_de_contrato_bm.medicao_vigente == 'Não')+contrato.medicao_de_contrato_bm.faturamento_direto_ftd_na_fase_atual\ncontrato.valor_total_do_contrato - sum(contrato.medicao_de_contrato_bm.medicao_atual_a, contrato.medicao_de_contrato_bm.medicao_vigente == 'Não')\nlast(contrato.medicao_de_contrato_bm.pedido_sap_de_bm.medicao_atual)\ncontrato.medicao_de_contrato_bm.medicao_atual_a - contrato.medicao_de_contrato_bm.faturamento_direto_ftd_na_fase_atual\ncontrato.medicao_de_contrato_bm.valor_total_vigente - contrato.medicao_de_contrato_bm.faturamento_direto_ftd_acumulado\nsum(contrato.medicao_de_contrato_bm.medicao_atual_a)\n(contrato.medicao_de_contrato_bm.saldo_contratual_r * 100)/ contrato.valor_total_do_contrato\n(contrato.percentual_reidi/100) * contrato.medicao_de_contrato_bm.medicao_atual_a\ncaucao_atual =  (contrato.percentual/100) * last(contrato.medicao_de_contrato_bm.medicao_equivalente_liquida_do_reidi_f_a_e)\n\nacumulado_caucao = sum(contrato.medicao_de_contrato_bm.caucao_contratual_g_5_f, contrato.medicao_de_contrato_bm.medicao_vigente == 'Não')+caucao_atual\n\nporcentagem_total = 0.03 * contrato.medicao_de_contrato_bm.valor_do_contrato\n\nif acumulado_caucao > porcentagem_total:\n    return 0\nelse:\n    return caucao_atual\ncontrato.medicao_de_contrato_bm.contract_measurement_item.valor_total_medido - contrato.medicao_de_contrato_bm.contract_measurement_item.saldo_anterior\ncontrato.medicao_de_contrato_bm.contract_measurement_item.valor_total_medido + contrato.medicao_de_contrato_bm.contract_measurement_item.valor_total_acumulado_anterior\nvalor_unitario = max(contrato.item_de_contrato.valor_unitario, contrato.item_de_contrato.chave_do_registro == contrato.medicao_de_contrato_bm.contract_measurement_item.item)\n\nsum(contrato.registro_de_medicao_de_contrato.funcao_no_registro_bm.quantidade_medida * valor_unitario, contrato.registro_de_medicao_de_contrato.funcao_no_registro_bm.item == contrato.medicao_de_contrato_bm.contract_measurement_item.item)\ncontrato.medicao_de_contrato_bm.medicao_atual_com_desconto_de_ftd_b - contrato.medicao_de_contrato_bm.desconto_do_reidi_c_3_65_b\nsum(contrato.registro_de_medicao_de_contrato.funcao_no_registro_bm.quantidade_medida, contrato.registro_de_medicao_de_contrato.funcao_no_registro_bm.item == contrato.medicao_de_contrato_bm.contract_measurement_item.item)\ncontrato.medicao_de_contrato_bm.contract_measurement_item.quantidade_acumulada_anterior + contrato.medicao_de_contrato_bm.contract_measurement_item.quantidade_medida\n2*2\n2*2\ncontrato.valor_total_do_contrato\nvalor_ativo = sum(contrato.medicao_de_contrato_bm.pedido_sap_de_bm.medicao_atual, contrato.medicao_de_contrato_bm.medicao_vigente = 'Sim')\nsum(contrato.medicao_de_contrato_bm.ftd_de_bm.valor_total_da_nota_fiscal, contrato.medicao_de_contrato_bm.medicao_vigente == 'Não')+contrato.medicao_de_contrato_bm.faturamento_direto_ftd_na_fase_atual\ncontrato.valor_total_do_contrato - sum(contrato.medicao_de_contrato_bm.medicao_atual_a, contrato.medicao_de_contrato_bm.medicao_vigente == 'Não')\nsum(contrato.medicao_de_contrato_bm.medicao_atual_a, contrato.medicao_de_contrato_bm.medicao_vigente == 'Sim')\ncontrato.medicao_de_contrato_bm.medicao_atual_a - contrato.medicao_de_contrato_bm.faturamento_direto_ftd_na_fase_atual\ncontrato.medicao_de_contrato_bm.valor_total_vigente - contrato.medicao_de_contrato_bm.faturamento_direto_ftd_acumulado\nsum(contrato.medicao_de_contrato_bm.medicao_atual_a)\n(contrato.medicao_de_contrato_bm.saldo_contratual_r * 100)/ contrato.valor_total_do_contrato\nvalor_percentual = (contrato.percentual_reidi * contrato.medicao_de_contrato_bm.medicao_atual_a)/100\nreid_acumulado = sum(contrato.medicao_de_contrato_bm.desconto_do_reidi_c_3_65_b, contrato.medicao_de_contrato_bm.medicao_vigente == 'Não') + valor_percentual\nvalor_maximo = (contrato.valor_total_do_contrato * 3,65)/100\n\nif reid_acumulado > valor_maximo:\n    return contrato.medicao_de_contrato_bm.medicao_atual_a\nelse\n\treturn contrato.medicao_de_contrato_bm.medicao_atual_a - valor_percentual\n2*2"

['contrato.valor_total_do_contrato', 'contrato.medicao_de_contrato_bm.pedido_sap_de_bm.medicao_atual', 'contrato.medicao_de_contrato_bm.medicao_vigente', 'contrato.medicao_de_contrato_bm.ftd_de_bm.valor_total_da_nota_fiscal', 'contrato.medicao_de_contrato_bm.medicao_vigente', 'contrato.medicao_de_contrato_bm.faturamento_direto_ftd_na_fase_atual', 'contrato.valor_total_do_contrato', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.medicao_de_contrato_bm.medicao_vigente', 'contrato.medicao_de_contrato_bm.pedido_sap_de_bm.medicao_atual', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.medicao_de_contrato_bm.faturamento_direto_ftd_na_fase_atual', 'contrato.medicao_de_contrato_bm.valor_total_vigente', 'contrato.medicao_de_contrato_bm.faturamento_direto_ftd_acumulado', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.medicao_de_contrato_bm.saldo_contratual_r', 'contrato.valor_total_do_contrato', 'contrato.percentual_reidi', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.percentual', 'contrato.medicao_de_contrato_bm.medicao_equivalente_liquida_do_reidi_f_a_e', 'contrato.medicao_de_contrato_bm.caucao_contratual_g_5_f', 'contrato.medicao_de_contrato_bm.medicao_vigente', '0.03', 'contrato.medicao_de_contrato_bm.valor_do_contrato', 'contrato.medicao_de_contrato_bm.contract_measurement_item.valor_total_medido', 'contrato.medicao_de_contrato_bm.contract_measurement_item.saldo_anterior', 'contrato.medicao_de_contrato_bm.contract_measurement_item.valor_total_medido', 'contrato.medicao_de_contrato_bm.contract_measurement_item.valor_total_acumulado_anterior', 'contrato.item_de_contrato.valor_unitario', 'contrato.item_de_contrato.chave_do_registro', 'contrato.medicao_de_contrato_bm.contract_measurement_item.item', 'contrato.registro_de_medicao_de_contrato.funcao_no_registro_bm.quantidade_medida', 'contrato.registro_de_medicao_de_contrato.funcao_no_registro_bm.item', 'contrato.medicao_de_contrato_bm.contract_measurement_item.item', 'contrato.medicao_de_contrato_bm.medicao_atual_com_desconto_de_ftd_b', 'contrato.medicao_de_contrato_bm.desconto_do_reidi_c_3_65_b', 'contrato.registro_de_medicao_de_contrato.funcao_no_registro_bm.quantidade_medida', 'contrato.registro_de_medicao_de_contrato.funcao_no_registro_bm.item', 'contrato.medicao_de_contrato_bm.contract_measurement_item.item', 'contrato.medicao_de_contrato_bm.contract_measurement_item.quantidade_acumulada_anterior', 'contrato.medicao_de_contrato_bm.contract_measurement_item.quantidade_medida', 'contrato.valor_total_do_contrato', 'contrato.medicao_de_contrato_bm.pedido_sap_de_bm.medicao_atual', 'contrato.medicao_de_contrato_bm.medicao_vigente', 'contrato.medicao_de_contrato_bm.ftd_de_bm.valor_total_da_nota_fiscal', 'contrato.medicao_de_contrato_bm.medicao_vigente', 'contrato.medicao_de_contrato_bm.faturamento_direto_ftd_na_fase_atual', 'contrato.valor_total_do_contrato', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.medicao_de_contrato_bm.medicao_vigente', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.medicao_de_contrato_bm.medicao_vigente', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.medicao_de_contrato_bm.faturamento_direto_ftd_na_fase_atual', 'contrato.medicao_de_contrato_bm.valor_total_vigente', 'contrato.medicao_de_contrato_bm.faturamento_direto_ftd_acumulado', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.medicao_de_contrato_bm.saldo_contratual_r', 'contrato.valor_total_do_contrato', 'contrato.percentual_reidi', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.medicao_de_contrato_bm.desconto_do_reidi_c_3_65_b', 'contrato.medicao_de_contrato_bm.medicao_vigente', 'contrato.valor_total_do_contrato', 'contrato.medicao_de_contrato_bm.medicao_atual_a', 'contrato.medicao_de_contrato_bm.medicao_atual_a']